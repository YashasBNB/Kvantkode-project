/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
import assert from 'assert';
import { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';
import { Position } from '../../../common/core/position.js';
import { Range } from '../../../common/core/range.js';
import { ViewEventHandler } from '../../../common/viewEventHandler.js';
import { testViewModel } from './testViewModel.js';
suite('ViewModel', () => {
    ensureNoDisposablesAreLeakedInTestSuite();
    test("issue #21073: SplitLinesCollection: attempt to access a 'newer' model", () => {
        const text = [''];
        const opts = {
            lineNumbersMinChars: 1,
        };
        testViewModel(text, opts, (viewModel, model) => {
            assert.strictEqual(viewModel.getLineCount(), 1);
            viewModel.setViewport(1, 1, 1);
            model.applyEdits([
                {
                    range: new Range(1, 1, 1, 1),
                    text: [
                        'line01',
                        'line02',
                        'line03',
                        'line04',
                        'line05',
                        'line06',
                        'line07',
                        'line08',
                        'line09',
                        'line10',
                    ].join('\n'),
                },
            ]);
            assert.strictEqual(viewModel.getLineCount(), 10);
        });
    });
    test("issue #44805: SplitLinesCollection: attempt to access a 'newer' model", () => {
        const text = [''];
        testViewModel(text, {}, (viewModel, model) => {
            assert.strictEqual(viewModel.getLineCount(), 1);
            model.pushEditOperations([], [
                {
                    range: new Range(1, 1, 1, 1),
                    text: '\ninsert1',
                },
            ], () => []);
            model.pushEditOperations([], [
                {
                    range: new Range(1, 1, 1, 1),
                    text: '\ninsert2',
                },
            ], () => []);
            model.pushEditOperations([], [
                {
                    range: new Range(1, 1, 1, 1),
                    text: '\ninsert3',
                },
            ], () => []);
            const viewLineCount = [];
            viewLineCount.push(viewModel.getLineCount());
            const eventHandler = new (class extends ViewEventHandler {
                handleEvents(events) {
                    // Access the view model
                    viewLineCount.push(viewModel.getLineCount());
                }
            })();
            viewModel.addViewEventHandler(eventHandler);
            model.undo();
            viewLineCount.push(viewModel.getLineCount());
            assert.deepStrictEqual(viewLineCount, [4, 1, 1, 1, 1]);
            viewModel.removeViewEventHandler(eventHandler);
            eventHandler.dispose();
        });
    });
    test('issue #44805: No visible lines via API call', () => {
        const text = ['line1', 'line2', 'line3'];
        testViewModel(text, {}, (viewModel, model) => {
            assert.strictEqual(viewModel.getLineCount(), 3);
            viewModel.setHiddenAreas([new Range(1, 1, 3, 1)]);
            assert.ok(viewModel.getVisibleRanges() !== null);
        });
    });
    test('issue #44805: No visible lines via undoing', () => {
        const text = [''];
        testViewModel(text, {}, (viewModel, model) => {
            assert.strictEqual(viewModel.getLineCount(), 1);
            model.pushEditOperations([], [
                {
                    range: new Range(1, 1, 1, 1),
                    text: 'line1\nline2\nline3',
                },
            ], () => []);
            viewModel.setHiddenAreas([new Range(1, 1, 1, 1)]);
            assert.strictEqual(viewModel.getLineCount(), 2);
            model.undo();
            assert.ok(viewModel.getVisibleRanges() !== null);
        });
    });
    function assertGetPlainTextToCopy(text, ranges, emptySelectionClipboard, expected) {
        testViewModel(text, {}, (viewModel, model) => {
            const actual = viewModel.getPlainTextToCopy(ranges, emptySelectionClipboard, false);
            assert.deepStrictEqual(actual, expected);
        });
    }
    const USUAL_TEXT = ['', 'line2', 'line3', 'line4', ''];
    test('getPlainTextToCopy 0/1', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 2)], false, '');
    });
    test('getPlainTextToCopy 0/1 - emptySelectionClipboard', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 2)], true, 'line2\n');
    });
    test('getPlainTextToCopy 1/1', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 6)], false, 'ine2');
    });
    test('getPlainTextToCopy 1/1 - emptySelectionClipboard', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 6)], true, 'ine2');
    });
    test('getPlainTextToCopy 0/2', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 2), new Range(3, 2, 3, 2)], false, '');
    });
    test('getPlainTextToCopy 0/2 - emptySelectionClipboard', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 2), new Range(3, 2, 3, 2)], true, 'line2\nline3\n');
    });
    test('getPlainTextToCopy 1/2', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 6), new Range(3, 2, 3, 2)], false, 'ine2');
    });
    test('getPlainTextToCopy 1/2 - emptySelectionClipboard', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 6), new Range(3, 2, 3, 2)], true, [
            'ine2',
            'line3',
        ]);
    });
    test('getPlainTextToCopy 2/2', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 6), new Range(3, 2, 3, 6)], false, [
            'ine2',
            'ine3',
        ]);
    });
    test('getPlainTextToCopy 2/2 reversed', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(3, 2, 3, 6), new Range(2, 2, 2, 6)], false, [
            'ine2',
            'ine3',
        ]);
    });
    test('getPlainTextToCopy 0/3 - emptySelectionClipboard', () => {
        assertGetPlainTextToCopy(USUAL_TEXT, [new Range(2, 2, 2, 2), new Range(2, 3, 2, 3), new Range(3, 2, 3, 2)], true, 'line2\nline3\n');
    });
    test('issue #22688 - always use CRLF for clipboard on Windows', () => {
        testViewModel(USUAL_TEXT, {}, (viewModel, model) => {
            model.setEOL(0 /* EndOfLineSequence.LF */);
            const actual = viewModel.getPlainTextToCopy([new Range(2, 1, 5, 1)], true, true);
            assert.deepStrictEqual(actual, 'line2\r\nline3\r\nline4\r\n');
        });
    });
    test('issue #40926: Incorrect spacing when inserting new line after multiple folded blocks of code', () => {
        testViewModel([
            'foo = {',
            '    foobar: function() {',
            '        this.foobar();',
            '    },',
            '    foobar: function() {',
            '        this.foobar();',
            '    },',
            '    foobar: function() {',
            '        this.foobar();',
            '    },',
            '}',
        ], {}, (viewModel, model) => {
            viewModel.setHiddenAreas([
                new Range(3, 1, 3, 1),
                new Range(6, 1, 6, 1),
                new Range(9, 1, 9, 1),
            ]);
            model.applyEdits([
                { range: new Range(4, 7, 4, 7), text: '\n    ' },
                { range: new Range(7, 7, 7, 7), text: '\n    ' },
                { range: new Range(10, 7, 10, 7), text: '\n    ' },
            ]);
            assert.strictEqual(viewModel.getLineCount(), 11);
        });
    });
    test('normalizePosition with multiple touching injected text', () => {
        testViewModel(['just some text'], {}, (viewModel, model) => {
            model.deltaDecorations([], [
                {
                    range: new Range(1, 8, 1, 8),
                    options: {
                        description: 'test',
                        before: {
                            content: 'bar',
                        },
                        showIfCollapsed: true,
                    },
                },
                {
                    range: new Range(1, 8, 1, 8),
                    options: {
                        description: 'test',
                        before: {
                            content: 'bz',
                        },
                        showIfCollapsed: true,
                    },
                },
            ]);
            // just sobarbzme text
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 8), 2 /* PositionAffinity.None */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 9), 2 /* PositionAffinity.None */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 11), 2 /* PositionAffinity.None */), new Position(1, 11));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 12), 2 /* PositionAffinity.None */), new Position(1, 11));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 13), 2 /* PositionAffinity.None */), new Position(1, 13));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 8), 0 /* PositionAffinity.Left */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 9), 0 /* PositionAffinity.Left */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 11), 0 /* PositionAffinity.Left */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 12), 0 /* PositionAffinity.Left */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 13), 0 /* PositionAffinity.Left */), new Position(1, 8));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 8), 1 /* PositionAffinity.Right */), new Position(1, 13));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 9), 1 /* PositionAffinity.Right */), new Position(1, 13));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 11), 1 /* PositionAffinity.Right */), new Position(1, 13));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 12), 1 /* PositionAffinity.Right */), new Position(1, 13));
            assert.deepStrictEqual(viewModel.normalizePosition(new Position(1, 13), 1 /* PositionAffinity.Right */), new Position(1, 13));
        });
    });
    test('issue #193262: Incorrect implementation of modifyPosition', () => {
        testViewModel(['just some text'], {
            wordWrap: 'wordWrapColumn',
            wordWrapColumn: 5,
        }, (viewModel, model) => {
            assert.deepStrictEqual(new Position(3, 1), viewModel.modifyPosition(new Position(3, 2), -1));
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlld01vZGVsSW1wbC50ZXN0LmpzIiwic291cmNlUm9vdCI6ImZpbGU6Ly8vVXNlcnMveWFzaGFzbmFpZHUvS3ZhbnRjb2RlL0t2YW50a29kZS9zcmMvIiwic291cmNlcyI6WyJ2cy9lZGl0b3IvdGVzdC9icm93c2VyL3ZpZXdNb2RlbC92aWV3TW9kZWxJbXBsLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztnR0FHZ0c7QUFFaEcsT0FBTyxNQUFNLE1BQU0sUUFBUSxDQUFBO0FBQzNCLE9BQU8sRUFBRSx1Q0FBdUMsRUFBRSxNQUFNLHVDQUF1QyxDQUFBO0FBQy9GLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQTtBQUMzRCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sK0JBQStCLENBQUE7QUFFckQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0scUNBQXFDLENBQUE7QUFFdEUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG9CQUFvQixDQUFBO0FBRWxELEtBQUssQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO0lBQ3ZCLHVDQUF1QyxFQUFFLENBQUE7SUFFekMsSUFBSSxDQUFDLHVFQUF1RSxFQUFFLEdBQUcsRUFBRTtRQUNsRixNQUFNLElBQUksR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQ2pCLE1BQU0sSUFBSSxHQUFHO1lBQ1osbUJBQW1CLEVBQUUsQ0FBQztTQUN0QixDQUFBO1FBQ0QsYUFBYSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxTQUFTLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDOUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsWUFBWSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFFL0MsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO1lBRTlCLEtBQUssQ0FBQyxVQUFVLENBQUM7Z0JBQ2hCO29CQUNDLEtBQUssRUFBRSxJ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