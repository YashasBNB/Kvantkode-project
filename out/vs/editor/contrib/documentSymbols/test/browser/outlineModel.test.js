/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
import assert from 'assert';
import { CancellationToken, CancellationTokenSource, } from '../../../../../base/common/cancellation.js';
import { DisposableStore } from '../../../../../base/common/lifecycle.js';
import { URI } from '../../../../../base/common/uri.js';
import { Range } from '../../../../common/core/range.js';
import { LanguageFeatureDebounceService } from '../../../../common/services/languageFeatureDebounce.js';
import { LanguageFeaturesService } from '../../../../common/services/languageFeaturesService.js';
import { IModelService } from '../../../../common/services/model.js';
import { createModelServices, createTextModel } from '../../../../test/common/testTextModel.js';
import { NullLogService } from '../../../../../platform/log/common/log.js';
import { MarkerSeverity } from '../../../../../platform/markers/common/markers.js';
import { OutlineElement, OutlineGroup, OutlineModel, OutlineModelService, } from '../../browser/outlineModel.js';
import { mock } from '../../../../../base/test/common/mock.js';
import { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';
suite('OutlineModel', function () {
    const disposables = new DisposableStore();
    const languageFeaturesService = new LanguageFeaturesService();
    teardown(function () {
        disposables.clear();
    });
    ensureNoDisposablesAreLeakedInTestSuite();
    test('OutlineModel#create, cached', async function () {
        const insta = createModelServices(disposables);
        const modelService = insta.get(IModelService);
        const envService = new (class extends mock() {
            constructor() {
                super(...arguments);
                this.isBuilt = true;
                this.isExtensionDevelopment = false;
            }
        })();
        const service = new OutlineModelService(languageFeaturesService, new LanguageFeatureDebounceService(new NullLogService(), envService), modelService);
        const model = createTextModel('foo', undefined, undefined, URI.file('/fome/path.foo'));
        let count = 0;
        const reg = languageFeaturesService.documentSymbolProvider.register({ pattern: '**/path.foo' }, {
            provideDocumentSymbols() {
                count += 1;
                return [];
            },
        });
        await service.getOrCreate(model, CancellationToken.None);
        assert.strictEqual(count, 1);
        // cached
        await service.getOrCreate(model, CancellationToken.None);
        assert.strictEqual(count, 1);
        // new version
        model.applyEdits([{ text: 'XXX', range: new Range(1, 1, 1, 1) }]);
        await service.getOrCreate(model, CancellationToken.None);
        assert.strictEqual(count, 2);
        reg.dispose();
        model.dispose();
        service.dispose();
    });
    test('OutlineModel#create, cached/cancel', async function () {
        const insta = createModelServices(disposables);
        const modelService = insta.get(IModelService);
        const envService = new (class extends mock() {
            constructor() {
                super(...arguments);
                this.isBuilt = true;
                this.isExtensionDevelopment = false;
            }
        })();
        const service = new OutlineModelService(languageFeaturesService, new LanguageFeatureDebounceService(new NullLogService(), envService), modelService);
        const model = createTextModel('foo', undefined, undefined, URI.file('/fome/path.foo'));
        let isCancelled = false;
        const reg = languageFeaturesService.documentSymbolProvider.register({ pattern: '**/path.foo' }, {
            provideDocumentSymbols(d, token) {
                return new Promise((resolve) => {
                    const l = token.onCancellationRequested((_) => {
                        isCancelled = true;
                        resolve(null);
                        l.dispose();
                    });
                });
            },
        });
        assert.strictEqual(isCancelled, false);
        const s1 = new CancellationTokenSource();
        service.getOrCreate(model, s1.token);
        const s2 = new CancellationTokenSource();
        service.getOrCreate(model, s2.token);
        s1.cancel();
        assert.strictEqual(isCancelled, false);
        s2.cancel();
        assert.strictEqual(isCancelled, true);
        reg.dispose();
        model.dispose();
        service.dispose();
    });
    function fakeSymbolInformation(range, name = 'foo') {
        return {
            name,
            detail: 'fake',
            kind: 16 /* SymbolKind.Boolean */,
            tags: [],
            selectionRange: range,
            range: range,
        };
    }
    function fakeMarker(range) {
        return {
            ...range,
            owner: 'ffff',
            message: 'test',
            severity: MarkerSeverity.Error,
            resource: null,
        };
    }
    test('OutlineElement - updateMarker', function () {
        const e0 = new OutlineElement('foo1', null, fakeSymbolInformation(new Range(1, 1, 1, 10)));
        const e1 = new OutlineElement('foo2', null, fakeSymbolInformation(new Range(2, 1, 5, 1)));
        const e2 = new OutlineElement('foo3', null, fakeSymbolInformation(new Range(6, 1, 10, 10)));
        const group = new OutlineGroup('group', null, null, 1);
        group.children.set(e0.id, e0);
        group.children.set(e1.id, e1);
        group.children.set(e2.id, e2);
        const data = [
            fakeMarker(new Range(6, 1, 6, 7)),
            fakeMarker(new Range(1, 1, 1, 4)),
            fakeMarker(new Range(10, 2, 14, 1)),
        ];
        data.sort(Range.compareRangesUsingStarts); // model does this
        group.updateMarker(data);
        assert.strictEqual(data.length, 0); // all 'stolen'
        assert.strictEqual(e0.marker.count, 1);
        assert.strictEqual(e1.marker, undefined);
        assert.strictEqual(e2.marker.count, 2);
        group.updateMarker([]);
        assert.strictEqual(e0.marker, undefined);
        assert.strictEqual(e1.marker, undefined);
        assert.strictEqual(e2.marker, undefined);
    });
    test('OutlineElement - updateMarker, 2', function () {
        const p = new OutlineElement('A', null, fakeSymbolInformation(new Range(1, 1, 11, 1)));
        const c1 = new OutlineElement('A/B', null, fakeSymbolInformation(new Range(2, 4, 5, 4)));
        const c2 = new OutlineElement('A/C', null, fakeSymbolInformation(new Range(6, 4, 9, 4)));
        const group = new OutlineGroup('group', null, null, 1);
        group.children.set(p.id, p);
        p.children.set(c1.id, c1);
        p.children.set(c2.id, c2);
        let data = [fakeMarker(new Range(2, 4, 5, 4))];
        group.updateMarker(data);
        assert.strictEqual(p.marker.count, 0);
        assert.strictEqual(c1.marker.count, 1);
        assert.strictEqual(c2.marker, undefined);
        data = [
            fakeMarker(new Range(2, 4, 5, 4)),
            fakeMarker(new Range(2, 6, 2, 8)),
            fakeMarker(new Range(7, 6, 7, 8)),
        ];
        group.updateMarker(data);
        assert.strictEqual(p.marker.count, 0);
        assert.strictEqual(c1.marker.count, 2);
        assert.strictEqual(c2.marker.count, 1);
        data = [fakeMarker(new Range(1, 4, 1, 11)), fakeMarker(new Range(7, 6, 7, 8))];
        group.updateMarker(data);
        assert.strictEqual(p.marker.count, 1);
        assert.strictEqual(c1.marker, undefined);
        assert.strictEqual(c2.marker.count, 1);
    });
    test('OutlineElement - updateMarker/multiple groups', function () {
        const model = new (class extends OutlineModel {
            constructor() {
                super(null);
            }
            readyForTesting() {
                this._groups = this.children;
            }
        })();
        model.children.set('g1', new OutlineGroup('g1', model, null, 1));
        model.children
            .get('g1')
            .children.set('c1', new OutlineElement('c1', model.children.get('g1'), fakeSymbolInformation(new Range(1, 1, 11, 1))));
        model.children.set('g2', new OutlineGroup('g2', model, null, 1));
        model.children
            .get('g2')
            .children.set('c2', new OutlineElement('c2', model.children.get('g2'), fakeSymbolInformation(new Range(1, 1, 7, 1))));
        model.children
            .get('g2')
            .children.get('c2')
            .children.set('c2.1', new OutlineElement('c2.1', model.children.get('g2').children.get('c2'), fakeSymbolInformation(new Range(1, 3, 2, 19))));
        model.children
            .get('g2')
            .children.get('c2')
            .children.set('c2.2', new OutlineElement('c2.2', model.children.get('g2').children.get('c2'), fakeSymbolInformation(new Range(4, 1, 6, 10))));
        model.readyForTesting();
        const data = [fakeMarker(new Range(1, 1, 2, 8)), fakeMarker(new Range(6, 1, 6, 98))];
        model.updateMarker(data);
        assert.strictEqual(model.children.get('g1').children.get('c1').marker.count, 2);
        assert.strictEqual(model.children.get('g2').children.get('c2').children.get('c2.1').marker.count, 1);
        assert.strictEqual(model.children.get('g2').children.get('c2').children.get('c2.2').marker.count, 1);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3V0bGluZU1vZGVsLnRlc3QuanMiLCJzb3VyY2VSb290IjoiZmlsZTovLy9Vc2Vycy95YXNoYXNuYWlkdS9LdmFudGNvZGUvdm9pZC9zcmMvIiwic291cmNlcyI6WyJ2cy9lZGl0b3IvY29udHJpYi9kb2N1bWVudFN5bWJvbHMvdGVzdC9icm93c2VyL291dGxpbmVNb2RlbC50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Z0dBR2dHO0FBRWhHLE9BQU8sTUFBTSxNQUFNLFFBQVEsQ0FBQTtBQUMzQixPQUFPLEVBQ04saUJBQWlCLEVBQ2pCLHVCQUF1QixHQUN2QixNQUFNLDRDQUE0QyxDQUFBO0FBQ25ELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQTtBQUN6RSxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sbUNBQW1DLENBQUE7QUFDdkQsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGtDQUFrQyxDQUFBO0FBRXhELE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLHdEQUF3RCxDQUFBO0FBQ3ZHLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHdEQUF3RCxDQUFBO0FBQ2hHLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQTtBQUNwRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsZUFBZSxFQUFFLE1BQU0sMENBQTBDLENBQUE7QUFDL0YsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDJDQUEyQyxDQUFBO0FBQzFFLE9BQU8sRUFBVyxjQUFjLEVBQUUsTUFBTSxtREFBbUQsQ0FBQTtBQUMzRixPQUFPLEVBQ04sY0FBYyxFQUNkLFlBQVksRUFDWixZQUFZLEVBQ1osbUJBQW1CLEdBQ25CLE1BQU0sK0JBQStCLENBQUE7QUFDdEMsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLHlDQUF5QyxDQUFBO0FBRTlELE9BQU8sRUFBRSx1Q0FBdUMsRUFBRSxNQUFNLDBDQUEwQyxDQUFBO0FBRWxHLEtBQUssQ0FBQyxjQUFj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VyxDQUFDLEVBQUUsQ0FBQyxNQUFPLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBQ3ZDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQTtRQUN4QyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxNQUFPLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBRXZDLEtBQUssQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDdEIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFBO1FBQ3hDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQTtRQUN4QyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUE7SUFDekMsQ0FBQyxDQUFDLENBQUE7SUFFRixJQUFJLENBQUMsa0NBQWtDLEVBQUU7UUFDeEMsTUFBTSxDQUFDLEdBQUcsSUFBSSxjQUFjLENBQUMsR0FBRyxFQUFFLElBQUssRUFBRSxxQkFBcUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDdkYsTUFBTSxFQUFFLEdBQUcsSUFBSSxjQUFjLENBQUMsS0FBSyxFQUFFLElBQUssRUFBRSxxQkFBcUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDekYsTUFBTSxFQUFFLEdBQUcsSUFBSSxjQUFjLENBQUMsS0FBSyxFQUFFLElBQUssRUFBRSxxQkFBcUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFFekYsTUFBTSxLQUFLLEdBQUcsSUFBSSxZQUFZ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